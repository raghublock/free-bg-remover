<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free BG Remover | 100% Free</title>
    <script src="https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.4.5/dist/bundle.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #f4f7f9; padding: 20px; }
        .card { background: white; max-width: 600px; margin: auto; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .upload-box { border: 2px dashed #007bff; padding: 30px; border-radius: 10px; cursor: pointer; background: #fdfdfd; margin-bottom: 20px; }
        .preview-section { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 20px; }
        .box { flex: 1; min-width: 250px; background: #fff; border: 1px solid #eee; padding: 10px; border-radius: 8px; }
        img { width: 100%; border-radius: 5px; display: none; margin-top: 10px; }
        #processBtn { background: #007bff; color: white; border: none; padding: 15px; width: 100%; border-radius: 30px; font-size: 18px; font-weight: bold; cursor: pointer; }
        #processBtn:disabled { background: #ccc; }
        #loader { display: none; color: #856404; background: #fff3cd; padding: 10px; border-radius: 5px; margin: 10px 0; }
        .dl-btn { display: none; background: #28a745; color: white; text-decoration: none; padding: 10px 20px; border-radius: 5px; margin-top: 10px; display: inline-block; }
    </style>
</head>
<body>

<div class="card">
    <h2>✂️ AI Background Remover</h2>
    <p>Free & Unlimited</p>

    <div class="upload-box" onclick="document.getElementById('inp').click()">
        <b id="statusText">Click to Upload Image</b>
        <input type="file" id="inp" accept="image/*" hidden>
    </div>

    <button id="processBtn">Remove Background</button>
    <div id="loader">AI Model is loading... (It may take 30-40 seconds for the first time)</div>

    <div class="preview-section">
        <div class="box">
            <strong>Original Image</strong>
            <img id="origImg">
            <p id="origName" style="font-size: 12px;"></p>
        </div>
        <div class="box">
            <strong>Result Image</strong>
            <img id="resImg">
            <a id="dl" class="dl-btn" download="no-bg.png" style="display:none;">Download HD</a>
        </div>
    </div>
</div>

<script>
    const inp = document.getElementById('inp');
    const origImg = document.getElementById('origImg');
    const resImg = document.getElementById('resImg');
    const btn = document.getElementById('processBtn');
    const loader = document.getElementById('loader');

    inp.onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
            origImg.src = URL.createObjectURL(file);
            origImg.style.display = "block";
            document.getElementById('origName').innerText = file.name;
            document.getElementById('statusText').innerText = "Selected: " + file.name;
            resImg.style.display = "none";
            document.getElementById('dl').style.display = "none";
        }
    };

    btn.onclick = async () => {
        if (!inp.files[0]) return alert("Please select a photo first!");

        loader.style.display = "block";
        btn.disabled = true;
        btn.innerText = "Processing...";

        try {
            // Updated Config to prevent loading errors
            const config = {
                publicPath: "https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.4.5/dist/" 
            };
            
            const blob = await imgly.backgroundRemoval(inp.files[0], config);
            const url = URL.createObjectURL(blob);
            
            resImg.src = url;
            resImg.style.display = "block";
            document.getElementById('dl').href = url;
            document.getElementById('dl').style.display = "inline-block";
            
            loader.style.display = "none";
        } catch (err) {
            console.error(err);
            alert("Error: Internet slow hai ya browser model load nahi kar pa raha. Please refresh karein.");
            loader.style.display = "none";
        }
        btn.disabled = false;
        btn.innerText = "Remove Background";
    };
</script>

</body>
</html>
