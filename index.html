<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fast AI BG Remover | Bikaner Edition</title>
    <script src="https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.4.5/dist/bundle.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; text-align: center; background: #f0f2f5; padding: 20px; }
        .card { background: white; max-width: 600px; margin: auto; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .upload-area { border: 2px dashed #007bff; padding: 30px; border-radius: 15px; cursor: pointer; background: #f8fbff; margin-bottom: 20px; transition: 0.3s; }
        .upload-area:hover { background: #eef6ff; }
        .preview-container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; margin-top: 25px; }
        .box { flex: 1; min-width: 250px; background: #fff; border: 1px solid #ddd; padding: 15px; border-radius: 12px; }
        img { width: 100%; border-radius: 8px; display: none; margin-top: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        #processBtn { background: #007bff; color: white; border: none; padding: 15px; width: 100%; border-radius: 30px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        #processBtn:hover { background: #0056b3; }
        #processBtn:disabled { background: #ccc; cursor: not-allowed; }
        #loader { display: none; color: #007bff; font-weight: bold; margin: 15px 0; padding: 10px; border: 1px solid #007bff; border-radius: 10px; }
        .dl-btn { display: none; background: #28a745; color: white; text-decoration: none; padding: 12px 25px; border-radius: 30px; margin-top: 15px; font-weight: bold; display: inline-block; }
        .share-btn { background: #25D366; color: white; text-decoration: none; padding: 10px 20px; border-radius: 30px; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; margin-top: 20px; font-size: 14px; }
        .privacy-box { margin-top: 25px; padding-top: 15px; border-top: 1px solid #eee; text-align: left; }
    </style>
</head>
<body>

<div class="card">
    <h2>üöÄ Super Fast BG Remover</h2>
    <p>AI Powered - Unlimited & Free</p>

    <div class="upload-area" onclick="document.getElementById('inp').click()">
        <b id="statusText">üìÅ Click here to Select Photo</b>
        <input type="file" id="inp" accept="image/*" hidden>
    </div>

    <button id="processBtn">Remove Background Now</button>
    <div id="loader">‚è≥ AI is processing... Please wait!</div>

    <div class="preview-container">
        <div class="box">
            <strong>Original Image</strong>
            <img id="origImg">
            <p id="origName" style="font-size: 12px; color: #666;"></p>
        </div>
        <div class="box">
            <strong>Result (Transparent)</strong>
            <img id="resImg">
            <a id="dl" class="dl-btn" target="_blank">üì• Download HD</a>
        </div>
    </div>

    <a id="whatsappShare" href="#" class="share-btn">Share on WhatsApp</a>

    <div class="privacy-box">
        <p style="font-size: 12px; color: #888; line-height: 1.5; margin: 0;">
            <strong>üîí Privacy Note:</strong> Hum aapki photos ko save nahi karte hain. 
            Saari images temporary process hoti hain aur kaam khatam hote hi delete ho jati hain. 
            Aapka data 100% safe hai.
        </p>
    </div>
</div>

<script>
    // --- APNA PURANA CLOUDINARY LOGIC (UNAFFECTED) ---
    const CLOUD_NAME = "doaodzwor"; 
    const UPLOAD_PRESET = "ml_default"; 

    const inp = document.getElementById('inp');
    const origImg = document.getElementById('origImg');
    const resImg = document.getElementById('resImg');
    const btn = document.getElementById('processBtn');
    const loader = document.getElementById('loader');
    const dl = document.getElementById('dl');

    const shareBtn = document.getElementById('whatsappShare');
    shareBtn.href = `https://api.whatsapp.com/send?text=Yaar ye mast free AI tool dekho, ek click mein background hatayein: ${window.location.href}`;

    inp.onchange = (e) => {
        const file = e.target.files[0];
        if (file) {
            origImg.src = URL.createObjectURL(file);
            origImg.style.display = "block";
            document.getElementById('origName').innerText = "Selected: " + file.name;
            document.getElementById('statusText').innerText = "Ready: " + file.name;
            resImg.style.display = "none";
            dl.style.display = "none";
        }
    };

    btn.onclick = async () => {
        const file = inp.files[0];
        if (!file) return alert("Bhai, pehle photo toh select kar lo!");

        loader.style.display = "block";
        btn.disabled = true;

        // --- STEP 1: Pehle Browser-based AI try karein (SAVES CREDITS) ---
        try {
            loader.innerText = "Processing (Mode: Fast)...";
            const config = { publicPath: "https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.4.5/dist/" };
            const blob = await imgly.backgroundRemoval(file, config);
            const url = URL.createObjectURL(blob);
            showResult(url);
        } 
        catch (err) {
            // --- STEP 2: Agar error aaye toh PURANA CLOUDINARY LOGIC chalu ho jayega ---
            console.log("Switching to Cloud AI...");
            loader.innerText = "Enhancing Results (Mode: Cloud)...";
            
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', UPLOAD_PRESET);

                const uploadRes = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
                    method: 'POST',
                    body: formData
                });
                const data = await uploadRes.json();
                const finalUrl = `https://res.cloudinary.com/${CLOUD_NAME}/image/upload/e_background_removal/${data.public_id}.${data.format}`;
                showResult(finalUrl);
            } catch (cloudErr) {
                alert("Error: Internet slow hai ya upload fail hua!");
            }
        }
        
        loader.style.display = "none";
        btn.disabled = false;
        btn.innerText = "Remove Background Now";
    };

    function showResult(url) {
        resImg.src = url;
        resImg.style.display = "block";
        dl.href = url;
        dl.style.display = "inline-block";
    }
</script>

</body>
</html>
